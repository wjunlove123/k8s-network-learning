date
Thu 18 May 2023 04:53:24 PM CST

cilium clustermesh enable --context kind-cluster1 --service-type NodePort
âš ï¸  Using service type NodePort may fail when nodes are removed from the cluster!
ğŸ”‘ Found CA in secret cilium-ca
ğŸ”‘ Generating certificates for ClusterMesh...
âœ¨ Deploying clustermesh-apiserver from quay.io/cilium/clustermesh-apiserver:v1.12.0...
âœ… ClusterMesh enabled!
cilium clustermesh enable --context kind-cluster2 --service-type NodePort
âš ï¸  Using service type NodePort may fail when nodes are removed from the cluster!
ğŸ”‘ Found CA in secret cilium-ca
ğŸ”‘ Generating certificates for ClusterMesh...
âœ¨ Deploying clustermesh-apiserver from quay.io/cilium/clustermesh-apiserver:v1.12.0...
âœ… ClusterMesh enabled!

cilium clustermesh connect --context kind-cluster1 --destination-context kind-cluster2
âœ¨ Extracting access information of cluster cluster2...
ğŸ”‘ Extracting secrets from cluster cluster2...
âš ï¸  Service type NodePort detected! Service may fail when nodes are removed from the cluster!
â„¹ï¸  Found ClusterMesh service IPs: [172.18.0.5]
âœ¨ Extracting access information of cluster cluster1...
ğŸ”‘ Extracting secrets from cluster cluster1...
âš ï¸  Service type NodePort detected! Service may fail when nodes are removed from the cluster!
â„¹ï¸  Found ClusterMesh service IPs: [172.18.0.3]
âœ¨ Connecting cluster kind-cluster1 -> kind-cluster2...
ğŸ”‘ Secret cilium-clustermesh does not exist yet, creating it...
ğŸ”‘ Patching existing secret cilium-clustermesh...
âœ¨ Patching DaemonSet with IP aliases cilium-clustermesh...
âœ¨ Connecting cluster kind-cluster2 -> kind-cluster1...
ğŸ”‘ Secret cilium-clustermesh does not exist yet, creating it...
ğŸ”‘ Patching existing secret cilium-clustermesh...
âœ¨ Patching DaemonSet with IP aliases cilium-clustermesh...
âœ… Connected cluster kind-cluster1 and kind-cluster2!

cilium clustermesh status  --context kind-cluster1 --wait
âš ï¸  Service type NodePort detected! Service may fail when nodes are removed from the cluster!
âœ… Cluster access information is available:
  - 172.18.0.3:31848
âœ… Service "clustermesh-apiserver" of type "NodePort" found
âŒ› [kind-cluster1] Waiting for deployment clustermesh-apiserver to become ready...
âœ… All 2 nodes are connected to all clusters [min:1 / avg:1.0 / max:1]
ğŸ”Œ Cluster Connections:
- cluster2: 2/2 configured, 2/2 connected
ğŸ”€ Global services: [ min:3 / avg:3.0 / max:3 ]

